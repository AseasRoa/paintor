var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{eK:()=>f,ZP:()=>d,Iv:()=>p});class n{elements=[];addElement(e){this.elements.push(e)}getElements(){return this.elements}importElements(e){const t=e.getElements();for(const e of t)this.addElement(e)}removeAllElements(){this.elements=[]}removeTheseElements(e){if(e.length>0){const t=[];for(const n of this.elements)-1===e.indexOf(n)&&t.push(n);this.elements=t}}}function s(e,t){for(const n of e)t.push(n);return t}function o(e,t,n){if(!(e instanceof Node)||"string"!=typeof t||"function"!=typeof n)return!1;const s=t.toLowerCase();return 0===s.indexOf("on")&&(e.addEventListener(s.substr(2),n),!0)}function r(e,...t){for(const n of t)if(n instanceof Array)if(n.length>1){const t=new DocumentFragment;for(const e of n)e&&t.append(e);e.appendChild(t)}else 1===n.length&&e.appendChild(n[0]);else n instanceof Node&&e.append(n)}function i(e,t,n){t in e?e[t]=n:e.setAttribute(t,n)}function l(e,t){let n=t;return"visibility"!==e&&"backfaceVisibility"!==e||!0!==t&&!1!==t&&null!=t||(n=t?"visible":"hidden"),"display"!==e||!0!==t&&!1!==t&&null!=t||(n=t?"":"none"),"flex"!==e||!0!==t&&!1!==t&&null!=t||(n=t?1:0),n}const c=["a","abbr","address","applet","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];class a{#collectedElements=[new n];#paintorWrapper;constructor(e){this.#paintorWrapper=e}createElement(e,...t){const n=document.createElement(e);let o=[],i=0;for(const e of t)if(i+=1,"string"==typeof e||"number"==typeof e)n.textContent=e;else if(e instanceof Function){const t="propertyName",s=e;this.#subscribeToBindings({element:n,propertyName:t,bindFunction:s}),n[t]=s(n)}else e instanceof Node?o.push(e):e instanceof Array?o=s(e,o):e instanceof Error?n.textContent=e:e instanceof Object&&1===i&&this.#setPropertiesToElement({element:n,properties:e});if(r(n,o),o.length>=0){const e=this.#collectedElements.length-1;this.#collectedElements[e].removeTheseElements(o),this.#collectedElements[e].addElement(n)}return n}finalPaint(){r(this.#paintorWrapper.containerElement,this.#collectedElements[0].getElements()),this.#collectedElements=[new n]}forLoop(...e){if(e.length<2||e.length>3)return new Error(`Wrong number of arguments. Expected 2 or 3, got ${e.length}`);let t,n,s=0,o=0,r=0;2===e.length?([t,n]=e,"number"!=typeof e[0]?r=1:(r=2,e[0]>=0?(s=0,o=e[0]-1):(s=-e[0]-1,o=0))):3===e.length&&([s,o,n]=e,r=3);const i=this.#beforeStatement();let l=null;1===r?l=function(e,t){if(!(e instanceof Object||e instanceof Array))return new Error('"data" argument should be an Object or an Array');if(!(t instanceof Function))return new Error('"handler" argument should be a Function');for(const n in e)if(!1===t(n,e[n]))break;return!0}(t,n):2!==r&&3!==r||(l=function(e,t,n){if("number"!=typeof e||"number"!=typeof t)return new Error('"start" and "end" arguments should be numbers');if(!(n instanceof Function))return new Error('"handler" argument should be a Function');if(t>=e)for(let s=e;s<=t&&!1!==n(s);s++);else for(let s=e;s>=t&&!1!==n(s);s--);return!0}(s,o,n));const c=this.#afterStatement(i);return l instanceof Error?l:c}if(e,t){const{thisLevel:n,upperLevel:s}=this.#beforeStatement();if("function"==typeof e){const s=e,o=document.createComment("IF BEGIN");this.#collectedElements[n].addElement(o);const r=e=>{this.#collectedElements[0].removeAllElements(),this.#removeStatementElements(o),e&&t(),this.#insertStatementElements(o,this.#collectedElements[0].getElements())||console.error("Element ",o," does not exist anymore")};this.#subscribeToBindings({element:o,propertyName:"--if",bindFunction:s,statementCallback:r})}if((e instanceof Function?e():e)&&"function"==typeof t&&t(),"function"==typeof e){const e=document.createComment("IF END");this.#collectedElements[n].addElement(e)}return this.#afterStatement({thisLevel:n,upperLevel:s})}#insertStatementElements(e,t){let n=e;if(!1===document.body.contains(n))return!1;for(const e of t)s=e,(o=n).parentNode.insertBefore(s,o.nextSibling),n=e;var s,o;return!0}#removeStatementElements(e){if(e.nodeType!==Node.COMMENT_NODE)return-1;const t=e.textContent;let n="";if("IF BEGIN"===t)n="IF END";else{if("FOR BEGIN"!==t)return-1;n="FOR END"}let s=e.nextSibling,o=0,r=0;for(;null!==s;){let e=!1;if(s.nodeType===Node.COMMENT_NODE){const r=s.textContent;if(r===t)o+=1,e=!0;else if(r===n&&(o-=1,o<0))break}const{nextSibling:i}=s;e&&(s["--deleted"]=!0),s.remove(),r+=1,s=i}return r}#beforeStatement(){const e=this.#collectedElements.length,t=e-1;return this.#collectedElements.push(new n),{thisLevel:e,upperLevel:t}}#afterStatement({thisLevel:e,upperLevel:t}){const n=this.#collectedElements[e].getElements();return this.#collectedElements[t].importElements(this.#collectedElements[e]),this.#collectedElements[e].removeAllElements(),delete this.#collectedElements[e],this.#collectedElements.pop(),n}#setPropertiesToElement({element:e,properties:t}){for(const n in t){const s=t[n];if(!o(e,n,s))if(s instanceof Function){const t=s;this.#subscribeToBindings({element:e,propertyName:n,bindFunction:t}),i(e,n,t(e))}else if("style"===n&&s instanceof Object){const t=s;for(const s in t){const o=t[s];let r="";if(o instanceof Function){const t=o;this.#subscribeToBindings({element:e,propertyName:n,subPropertyName:s,bindFunction:t}),r=t(e)}else r=o;e.style[s]=l(s,r)}}else i(e,n,s)}}#subscribeToBindings({element:e,propertyName:t,subPropertyName:n="",bindFunction:s,statementCallback:o}){const r=function(e){const t=e.toString(),n=/(?:[^\w_$.]|^)([a-zA-Z_$][\w_$]*)\.([\w_$.]+)/g,s={};let o;for(;null!==(o=n.exec(t));){const t=o[1],n=o[2];t in s||(s[t]={}),n in s[t]||(s[t][n]=[]),s[t][n].includes(e)||s[t][n].push(e)}return s}(s);for(const i in r)if(i in this.#paintorWrapper.states)for(const l in r[i]){const r=l.split(".");let c=this.#paintorWrapper.states[i];for(let e=0;e<r.length-1;e++)c=c[r[e]];this.#paintorWrapper.states[i]["--subscribe"].subscribe(l,e,t,n,s,o)}}}Function.prototype.bindArgs=function(...e){const t=this;return function(...n){return t.call(this,...e,...n)}};for(const e of c)a.prototype[e]=a.prototype.createElement.bindArgs(e);a.prototype.for=a.prototype.forLoop;class u{#containerElement=null;#states={};constructor(e,t,n){const s=new a(this);this.#initConstructorArguments(e,t,n)instanceof Error||(this.#clearContainerElement(),n(s),s.finalPaint())}get containerElement(){return this.#containerElement}get states(){return this.#states}#initConstructorArguments(e,t,n){if(e instanceof Node)this.#containerElement=e;else{if("string"!=typeof e)return new Error(`Wrong type for the container element. Expected <string> or <Node>, got <${typeof e}>`);if(this.#containerElement=document.getElementById(e),!this.#containerElement)return new Error(`Could not locate element #${e}`)}if(!(t instanceof Object))return new Error("states must be an Object");for(const e in t)"--state-path"in t[e]?this.states[e]=t[e]:console.error(`The input "${e}" is "${typeof t[e]}", but it should be a state`);return"function"==typeof n||new Error("treeFunction must be a function")}#clearContainerElement(){const e=this.#containerElement;for(;e.firstChild;)e.removeChild(e.firstChild)}}class m{subscriptions={};proxy;constructor(e){this.proxy=this.#createProxy(e)}getState(){return this.proxy}subscribe(e,t,n,s,o,r){this.subscriptions[e]=this.subscriptions[e]||[];for(const i of this.subscriptions[e])if(i.element===t&&i.propertyName===n&&i.subPropertyName===s&&i.bindFunction===o&&i.statementCallback===r)return;this.subscriptions[e].push({element:t,propertyName:n,subPropertyName:s,bindFunction:o,statementCallback:r})}unsubscribe(e){for(const t in this.subscriptions){const n=this.subscriptions[t];let s=!1;for(let t=0;t<n.length;t++)n[t].element===e&&(delete n[t],s=!0);s&&(this.subscriptions[t]=this.subscriptions[t].filter(Boolean))}}#createProxy(e,t=""){const n={};n.get=(e,t)=>"--subscribe"===t?this:e[t],n.set=(e,t,n)=>{if("--subscribe"===t)return!0;e[t]=n;let s=e["--state-path"];if(s=s?`${s}.${t}`:t,s in this.subscriptions){const e=this.subscriptions[s]||[];for(const t in e){const{element:n,propertyName:s,subPropertyName:o,bindFunction:r,statementCallback:c}=e[t];if(n["--deleted"])this.unsubscribe(n);else{const e=r(n);"style"===s&&o?n.style[o]=l(o,e):"--if"===s?c(e):i(n,s,e)}}}return!0};const s=new Proxy(e,n);Object.defineProperty(s,"--state-path",{enumerable:!1,configurable:!1,writable:!1,value:t});for(const e in s)if(s[e]instanceof Object){const n=""===t?e:`${t}.${e}`;s[e]=this.#createProxy(s[e],n)}return s}}function f(e){return new m(e).getState()}const p=function(e,t,n){return new u(e,t,n)};p.state=f,p.createState=f;const d=p;var h=t.eK,b=t.ZP,E=t.Iv;export{h as createState,b as default,E as paintor};
//# sourceMappingURL=paintor.min.js.map