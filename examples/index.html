<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <base href="http://localhost:8080">
  <link rel="stylesheet" href="/examples/style.css">
  <link rel="stylesheet" href="/examples/highlight/github-dark-dimmed.min.css">
  <script src="/examples/highlight/highlight.min.js"></script>
  <script type="module">
    // Typings are working when importing directly from the source
    import { paintor, createState } from '/src/index.js'

    // Or, load from the dist, but typings are probably not working
    //import { paintor, createState } from '/dist/paintor.min.js'

    class Tests {
      constructor() {
        this.#init()
      }

      exampleCreateElements() {
        paintor('container', {}, ($) => {
          $.div('div 1')
          $.div('div 2')
          $.div('div 3')
        })
      }

      exampleCreateTable() {
        paintor('container', {}, ($) => {
          $.table(
            $.thead(
              $.tr(
                $.th({colspan: 3}, 'The table header')
              ),
            ),
            $.tr(
              $.td('Row 1, Column 1'),
              $.td('Row 1, Column 2'),
            ),
            $.tr(
              $.td('Row 2, Column 1'),
              $.td('Row 2, Column 2'),
            )
          )
        })
      }

      exampleClicksCounterOne() {
        const state = createState({clicks: 0})

        paintor('container', {state}, ($) => {
          $.button({
            textContent: 'Click me',
            onClick: () => {state.clicks++},
          })
          $.p({ textContent: () => (state.clicks) })
        })
      }

      exampleClicksCounterTwo() {
        const state = createState({clicks: 0})

        paintor('container', {state}, ($) => {
          $.button({
            textContent: () => `Clicked ${state.clicks} times`,
            onClick: () => {state.clicks++},
          })
          $.p({ textContent: () => (`${state.clicks} clicks`) })
        })
      }

      exampleClicksCounterThree() {
        const state = createState({clicksA: 0, clicksB: 0})

        paintor('container', {state}, ($) => {
          $.button({
            textContent: () => `Button A: ${state.clicksA} clicks`,
            onClick: () => {state.clicksA++},
          })
          $.button({
            textContent: () => `Button B: ${state.clicksB} clicks`,
            onClick: () => {state.clicksB++},
          })
          $.p({ innerHTML: () => (`Button A clicked <b>${state.clicksA}</b> times and Button B clicked <b>${state.clicksB}</b> times`) })
        })
      }

      exampleClicksCounterFour() {
        const stateA = createState({clicks: 0})
        const stateB = createState({clicks: 0})

        paintor('container', {stateA, stateB}, ($) => {
          $.button({
            textContent: () => `Button A: ${stateA.clicks} clicks`,
            onClick: () => {stateA.clicks++},
          })
          $.button({
            textContent: () => `Button B: ${stateB.clicks} clicks`,
            onClick: () => {stateB.clicks++},
          })
          $.p({ innerHTML: () => (`Button A clicked <b>${stateA.clicks}</b> times and Button B clicked <b>${stateB.clicks}</b> times`) })
        })
      }

      exampleClicksCounterFive() {
        const state = createState({
          A: {clicks: 0},
          B: {clicks: 0},
        })

        paintor('container', {state}, ($) => {
          $.button({
            textContent: () => `Button A: ${state.A.clicks} clicks`,
            onClick: () => {state.A.clicks++},
          })
          $.button({
            textContent: () => `Button B: ${state.B.clicks} clicks`,
            onClick: () => {state.B.clicks++},
          })
          $.p({ innerHTML: () => (`Button A clicked <b>${state.A.clicks}</b> times and Button B clicked <b>${state.B.clicks}</b> times`) })
        })
      }

      exampleForAndIf() {
        paintor('container', {}, ($) => {
          $.for(0, 10, (i) => {
            const isOddNumber = i % 2 > 0

            $.if(isOddNumber, () => {
              $.div({textContent: `index ${i}`})
            })
          })
        })
      }

      exampleDynamicIf() {
        const state = createState({clicks: 0})

        paintor('container', {state}, ($) => {
          $.button({
            textContent: () => `${state.clicks} clicks`,
            onClick: () => state.clicks++,
          })

          $.if(() => (state.clicks % 2 > 0), () => {
            $.div({textContent: () => `This div element is created only at odd number of clicks`})
          })
        })
      }

      exampleForWithArray() {
        const array = ['One', 'Two', 'Three']

        paintor('container', {}, ($) => {
          $.for(array, (key, value) => {
            $.div({textContent: `${key} => ${value}`})
          })
        })
      }

      exampleForWithObject() {
        const object = {
          'one': 'ONE',
          'two': 'TWO',
          'three': 'THREE'
        }

        paintor('container', {}, ($) => {
          $.for(object, (key, value) => {
            $.div({textContent: `${key}: ${value}`})
          })
        })
      }

      exampleInlineStyle() {
        paintor('container', {}, ($) => {
          $.p({
            style: 'color: blue; background-color: lightyellow; border: 1px solid red;',
            textContent: 'Hello, World!'
          })

          $.p({
            style: {color: 'Blue', backgroundColor: 'LightYellow', border: '1px solid red'},
            textContent: 'Hello, World!'
          })
        })
      }

      exampleInlineStyleBinding() {
        const state = createState({fontSize: 18})

        paintor('container', {state}, ($) => {
          $.button({
            textContent: () => `Decrease Font Size`,
            onClick: () => {state.fontSize--},
          })

          $.button({
            textContent: () => `Increase Font Size`,
            onClick: () => {state.fontSize++},
          })

          $.p({
            style: {
              fontSize: () => `${state.fontSize}px`
            },
            textContent: () => `Font size is ${state.fontSize}px`
          })
        })
      }

      example100000Elements() {
        const state = createState({ currentIndex: 0 })

        paintor('container', { state }, ($) => {
          for (let i = 0; i < 100000; i++) {
            $.button({
              textContent: i,
              style: {width: '46px', height: '46px'},
            })
          }
        })
      }

      example1000Elements() {
        const state = createState({currentIndex: 0})

        paintor('container', {state}, ($) => {
          $.div('Move your mouse over the buttons. On every mouse enter, the index of the current button is written in all buttons.')

          for (let i = 0; i < 1000; i++) {
            $.button({
              textContent: () => state.currentIndex,
              style: {width: '46px', height: '46px'},
              onMouseEnter: (event) => {state.currentIndex = i},
              onClick: (event) => {event.target.textContent = 'Hello'}
            })
          }
        })
      }

      /**
       * Initialize the menu buttons
       */
      #init() {
        document.querySelectorAll('#menu > button').forEach((element) => {
          element.onclick = (ev) => {
            // Draw the function contents
            const functionName = ev.target.dataset.function
            const element = document.querySelector('#functionContents code')
            console.log(element)

            element.innerHTML = this[functionName].toString().replace(/\n      /g, '\n')

            hljs.highlightElement(element, {language: 'javascript'})

            // Run the function
            this[functionName]()
          }
        })

        // Click at the first button to load the first example
        document.querySelector('#menu > button').click()
      }
    }

    new Tests()
  </script>
</head>
<body>
<div id="menu">
  <button data-function="exampleCreateElements">Create HTML Elements</button>
  <button data-function="exampleCreateTable">Create a Table</button>
  <button data-function="exampleClicksCounterOne">Clicks Counter 1</button>
  <button data-function="exampleClicksCounterTwo">Clicks Counter 2</button>
  <button data-function="exampleClicksCounterThree">Clicks Counter 3<br>One State</button>
  <button data-function="exampleClicksCounterFour">Clicks Counter 4<br>Two States</button>
  <button data-function="exampleClicksCounterFive">Clicks Counter 5<br>States in a State</button>
  <button data-function="exampleForAndIf">for() & if()</button>
  <button data-function="exampleDynamicIf">Dynamic if()</button>
  <button data-function="exampleForWithArray">for() With Array of Data</button>
  <button data-function="exampleForWithObject">for() With Object of Data</button>
  <button data-function="exampleInlineStyle">Inline Style</button>
  <button data-function="exampleInlineStyleBinding">Inline Style Binding</button>
  <button data-function="example100000Elements">100,000 Elements</button>
  <button data-function="example1000Elements">1,000 Elements with Bindings</button>
</div>
<div id="contents">
  <div id="container"></div>
</div>
<pre id="functionContents"><code></code></pre>
</pre>
</body>
</html>
